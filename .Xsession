#!/bin/bash

exec > $HOME/.xsession-errors.`hostname`

# if we have the zsh-exports let's use them
[[ -r $HOME/.zshrc.d/S06-exports ]] && source $HOME/.zshrc.d/S06-exports

xmodmap_here="$HOME/.Xmodmap-`hostname`"
[ -r $xmodmap_here ] && xmodmap $xmodmap_here

# force the name of the window-manager to be some shitty stuff
# as LG3D for Sun/Oracle Java 6 to prevent resizing-bugs
# dpkg: suckless-tools
which wmname >/dev/null 2>&1 && wmname LG3D

gnome-settings-daemon --debug > gsettings.log 2>&1 &

gnome-sound-applet &
bluetooth-applet &

which xscreensaver >/dev/null 2>&1 && xscreensaver -nosplash &

# start dropbox if available
# dpkg: nautilus-dropbox
which dropbox >/dev/null 2>&1 && dropbox start&

## might be helpful for problems with nm
#/usr/lib/policykit-1-gnome/polkit-gnome-authentication-agent-1 &

# start network-manager and/or wicd applet depending on which service is running
if [[ `/etc/init.d/network-manager status >/dev/null 2>&1 ; echo $?` -eq 0 ]]
then
	nm-applet &
fi

if [[ `/etc/init.d/wicd status >/dev/null 2>&1 ; echo $?` -eq 0 ]]
then
	wicd-gtk --tray &
fi

eval `gnome-keyring-daemon`

exec awesome
#exec ck-launch-session dbus-launch awesome
